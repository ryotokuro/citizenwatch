{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\autum\\\\OneDrive\\\\Documents\\\\Amazon\\\\citizenwatch\\\\src\\\\screens\\\\Capture.tsx\";\nimport React from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport Button from '@material-ui/core/Button';\nimport CameraIcon from '@material-ui/icons/PhotoCamera';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Grid from '@material-ui/core/Grid';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Container from '@material-ui/core/Container';\nimport { Auth } from 'aws-amplify';\nimport Webcam from \"react-webcam\";\nimport Paper from '@material-ui/core/Paper';\nimport TextField from '@material-ui/core/TextField';\nimport EXIF from 'exif-js';\nimport { withAuthenticator } from 'aws-amplify-react-native';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    icon: {\n      marginRight: theme.spacing(2)\n    },\n    heroContent: {\n      backgroundColor: theme.palette.background.paper,\n      padding: theme.spacing(8, 0, 6)\n    },\n    heroButtons: {\n      marginTop: theme.spacing(4)\n    },\n    captureButton: {\n      margin: 'auto'\n    },\n    cardGrid: {\n      paddingTop: theme.spacing(8),\n      paddingBottom: theme.spacing(8)\n    },\n    card: {\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'column'\n    },\n    cardMedia: {\n      paddingTop: '56.25%'\n    },\n    cardContent: {\n      flexGrow: 1\n    },\n    footer: {\n      backgroundColor: theme.palette.background.paper,\n      padding: theme.spacing(6)\n    },\n    video: {\n      width: '100%',\n      height: '50%',\n      facingMode: \"user\"\n    },\n    root: {\n      flexGrow: 1\n    },\n    title: {\n      flexGrow: 1\n    },\n    paper: {\n      padding: theme.spacing(2),\n      textAlign: 'center',\n      color: theme.palette.text.secondary\n    }\n  };\n});\n\nfunction Capture(_ref) {\n  var navigation = _ref.navigation;\n  var classes = useStyles();\n  var webcamRef = React.useRef(null);\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      imgSrc = _React$useState2[0],\n      setImgSrc = _React$useState2[1];\n\n  var _React$useState3 = React.useState(\"\"),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      imgComment = _React$useState4[0],\n      setImgComment = _React$useState4[1];\n\n  var _React$useState5 = React.useState(\"\"),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      latitude = _React$useState6[0],\n      setLatitude = _React$useState6[1];\n\n  var _React$useState7 = React.useState(\"\"),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      longitude = _React$useState8[0],\n      setLongitude = _React$useState8[1];\n\n  var capture = React.useCallback(function () {\n    getUser();\n    var imageSrc = webcamRef.current.getScreenshot();\n    setImgSrc(imageSrc);\n    fetch(imageSrc).then(function (res) {\n      return res.blob();\n    }).then(function (blob) {\n      var file2 = new File([blob], \"test.jpg\", {\n        type: \"image/jpg\"\n      });\n      console.log(file2);\n      EXIF.getData(file2, function () {\n        var exifData = EXIF.pretty(this);\n        var exifLong = EXIF.getTag(this, \"GPSLongitude\");\n        var exifLat = EXIF.getTag(this, \"GPSLatitude\");\n        var exifLat_final;\n\n        if (exifLat) {\n          var exifLatNum1 = exifLat[0].numerator / exifLat[0].denominator;\n          var exifLatNum2 = exifLat[1].numerator / exifLat[1].denominator;\n          var exifLatNum3 = exifLat[2].numerator / exifLat[2].denominator;\n          exifLat_final = exifLatNum1 + exifLatNum2 / 60 + exifLatNum3 / 3600;\n          exifLat_final = exifLat_final.toString();\n          setLatitude(exifLat_final);\n        }\n\n        var exifLong_final;\n\n        if (exifLong) {\n          var exifLongNum1 = exifLong[0].numerator / exifLong[0].denominator;\n          var exifLongNum2 = exifLong[1].numerator / exifLong[1].denominator;\n          var exifLongNum3 = exifLong[2].numerator / exifLong[2].denominator;\n          exifLong_final = exifLongNum1 + exifLongNum2 / 60 + exifLongNum3 / 3600;\n          exifLong_final = exifLong_final.toString();\n          setLongitude(exifLong_final);\n        }\n\n        if (exifLong && exifLat) {\n          geocodeLatLng(exifLat_final, exifLong_final);\n        }\n\n        console.log(latitude, longitude);\n        setLatLongByCurrentPosition(exifLat, exifLong);\n      });\n    });\n  }, [webcamRef, setImgSrc]);\n\n  function setLatLongByCurrentPosition(lat, long) {\n    if (lat || long) {\n      return;\n    }\n\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(getPosition);\n    }\n\n    function getPosition(position) {\n      console.log(position.coords.latitude, position.coords.longitude);\n      var lat_var = position.coords.latitude + \"\";\n      var long_var = position.coords.longitude + \"\";\n      setLongitude(long_var);\n      setLatitude(lat_var);\n      geocodeLatLng(lat_var, long_var);\n      alert(\"Your photo has been captured\");\n    }\n  }\n\n  var _React$useState9 = React.useState(\"\"),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      city = _React$useState10[0],\n      setCity = _React$useState10[1];\n\n  var _React$useState11 = React.useState(\"\"),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      suburb = _React$useState12[0],\n      setSuburb = _React$useState12[1];\n\n  var _React$useState13 = React.useState(\"\"),\n      _React$useState14 = _slicedToArray(_React$useState13, 2),\n      country = _React$useState14[0],\n      setCountry = _React$useState14[1];\n\n  function geocodeLatLng(lat, long) {\n    var API_KEY = \"HedZ30NsSEanvewLY-XkRQ43WOCSSBXqdhr1yvsuPz0\";\n    return new Promise(function (resolve) {\n      var url = \"https://reverse.geocoder.ls.hereapi.com/6.2/reversegeocode.json?apiKey=\" + API_KEY + \"&mode=retrieveAddresses&prox=\" + lat + \",\" + long;\n      fetch(url).then(function (res) {\n        return res.json();\n      }).then(function (resJson) {\n        if (resJson && resJson.Response && resJson.Response.View && resJson.Response.View[0] && resJson.Response.View[0].Result && resJson.Response.View[0].Result[0]) {\n          var address = resJson.Response.View[0].Result[0].Location.Address;\n          setCity(address.City);\n          setCountry(address.Country);\n          setSuburb(address.District);\n          console.log(resJson.Response.View[0].Result[0].Location.Address);\n          resolve(resJson.Response.View[0].Result[0].Location.Address.Label);\n        } else {\n          resolve();\n        }\n      }).catch(function (e) {\n        console.log('Error in getting the address from the coordinates', e);\n        resolve();\n      });\n    });\n  }\n\n  var _React$useState15 = React.useState(null),\n      _React$useState16 = _slicedToArray(_React$useState15, 2),\n      errorMsg = _React$useState16[0],\n      setErrorMsg = _React$useState16[1];\n\n  var signOut = function signOut() {\n    return _regeneratorRuntime.async(function signOut$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(Auth.signOut({\n              global: true\n            }));\n\n          case 3:\n            _context.next = 8;\n            break;\n\n          case 5:\n            _context.prev = 5;\n            _context.t0 = _context[\"catch\"](0);\n            console.log('error signing out: ', _context.t0);\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 5]], Promise);\n  };\n\n  var _React$useState17 = React.useState(\"\"),\n      _React$useState18 = _slicedToArray(_React$useState17, 2),\n      email = _React$useState18[0],\n      setEmail = _React$useState18[1];\n\n  var getUser = function getUser() {\n    var userInfo;\n    return _regeneratorRuntime.async(function getUser$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(Auth.currentUserInfo());\n\n          case 3:\n            userInfo = _context2.sent;\n            setEmail(userInfo.attributes.email);\n            _context2.next = 10;\n            break;\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.log('error getting user data: ', _context2.t0);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 7]], Promise);\n  };\n\n  var axios = require(\"axios\");\n\n  var apiMethod = function apiMethod() {\n    var imgSrc_API = imgSrc;\n    var imgComment_API = imgComment;\n    var date = new Date();\n    console.log(imgSrc);\n    console.log(imgComment);\n    console.log(latitude);\n    console.log(longitude);\n    console.log(email);\n    console.log(country);\n    console.log(city);\n    console.log(suburb);\n    axios.post(\"https://7juxc9c5n7.execute-api.ap-southeast-2.amazonaws.com/dev\", {\n      comment: imgComment_API,\n      image: imgSrc_API,\n      latitude: latitude,\n      longitude: longitude,\n      timestamp: date.toISOString(),\n      email: email,\n      city: city,\n      country: country,\n      suburb: suburb\n    }).then(function (response) {\n      alert(\"Your image has been uploaded!\");\n      console.log(response);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  var commentHandler = function commentHandler(event) {\n    setImgComment(event.target.value);\n  };\n\n  return React.createElement(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 5\n    }\n  }, React.createElement(CssBaseline, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 7\n    }\n  }), React.createElement(AppBar, {\n    position: \"static\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }\n  }, React.createElement(Toolbar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 9\n    }\n  }, React.createElement(CameraIcon, {\n    className: classes.icon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 11\n    }\n  }), React.createElement(Typography, {\n    variant: \"h6\",\n    className: classes.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 11\n    }\n  }, \"Citizen Watch\"), React.createElement(Button, {\n    color: \"inherit\",\n    onClick: function onClick() {\n      return signOut();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 11\n    }\n  }, \"Sign Out\"))), React.createElement(\"main\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 7\n    }\n  }, React.createElement(\"div\", {\n    className: classes.heroContent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 9\n    }\n  }, React.createElement(Container, {\n    maxWidth: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 11\n    }\n  }, React.createElement(Card, {\n    className: classes.card,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 11\n    }\n  }, React.createElement(Paper, {\n    className: classes.paper,\n    elevation: 5,\n    variant: \"outlined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 11\n    }\n  }, React.createElement(Webcam, {\n    className: classes.video,\n    audio: false,\n    ref: webcamRef,\n    screenshotFormat: \"image/jpeg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 13\n    }\n  })), React.createElement(CardContent, {\n    className: classes.cardContent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 11\n    }\n  }, React.createElement(TextField, {\n    fullWidth: true,\n    margin: \"normal\",\n    variant: \"filled\",\n    InputLabelProps: {\n      shrink: true\n    },\n    placeholder: \"Put your comment here\",\n    onChange: commentHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 13\n    }\n  })), React.createElement(CardActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 11\n    }\n  }, React.createElement(\"div\", {\n    className: classes.heroButtons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 282,\n      columnNumber: 11\n    }\n  }, React.createElement(Grid, {\n    container: true,\n    spacing: 2,\n    justify: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 13\n    }\n  }, React.createElement(Grid, {\n    item: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 15\n    }\n  }, React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    onClick: function onClick() {\n      return capture();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 17\n    }\n  }, \"Capture Photo\")), React.createElement(Grid, {\n    item: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 15\n    }\n  }, React.createElement(Button, {\n    variant: \"outlined\",\n    color: \"primary\",\n    onClick: function onClick() {\n      return apiMethod();\n    },\n    disabled: !imgSrc,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 17\n    }\n  }, \"Upload\")), React.createElement(Grid, {\n    item: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 15\n    }\n  }, React.createElement(Button, {\n    variant: \"contained\",\n    color: \"primary\",\n    href: \"/Home\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 17\n    }\n  }, \"Home\"))))))))));\n}\n\nexport default withAuthenticator(Capture);","map":{"version":3,"sources":["C:/Users/autum/OneDrive/Documents/Amazon/citizenwatch/src/screens/Capture.tsx"],"names":["React","AppBar","Button","CameraIcon","Card","CardActions","CardContent","CssBaseline","Grid","Toolbar","Typography","makeStyles","Container","Auth","Webcam","Paper","TextField","EXIF","withAuthenticator","useStyles","theme","icon","marginRight","spacing","heroContent","backgroundColor","palette","background","paper","padding","heroButtons","marginTop","captureButton","margin","cardGrid","paddingTop","paddingBottom","card","height","display","flexDirection","cardMedia","cardContent","flexGrow","footer","video","width","facingMode","root","title","textAlign","color","text","secondary","Capture","navigation","classes","webcamRef","useRef","useState","imgSrc","setImgSrc","imgComment","setImgComment","latitude","setLatitude","longitude","setLongitude","capture","useCallback","getUser","imageSrc","current","getScreenshot","fetch","then","res","blob","file2","File","type","console","log","getData","exifData","pretty","exifLong","getTag","exifLat","exifLat_final","exifLatNum1","numerator","denominator","exifLatNum2","exifLatNum3","toString","exifLong_final","exifLongNum1","exifLongNum2","exifLongNum3","geocodeLatLng","setLatLongByCurrentPosition","lat","long","navigator","geolocation","getCurrentPosition","getPosition","position","coords","lat_var","long_var","alert","city","setCity","suburb","setSuburb","country","setCountry","API_KEY","Promise","resolve","url","json","resJson","Response","View","Result","address","Location","Address","City","Country","District","Label","catch","e","errorMsg","setErrorMsg","signOut","global","email","setEmail","currentUserInfo","userInfo","attributes","axios","require","apiMethod","imgSrc_API","imgComment_API","date","Date","post","comment","image","timestamp","toISOString","response","error","commentHandler","event","target","value","shrink"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CameraIcon from '@material-ui/icons/PhotoCamera';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport CardMedia from '@material-ui/core/CardMedia';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Container from '@material-ui/core/Container';\r\nimport Link from '@material-ui/core/Link';\r\nimport { Pressable } from 'react-native';\r\nimport { Auth } from 'aws-amplify';\r\nimport Webcam from \"react-webcam\"; // Install with npm install react-webcam\r\nimport Paper from '@material-ui/core/Paper';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Home from './Home';\r\nimport EXIF from 'exif-js'\r\nimport { withAuthenticator } from 'aws-amplify-react-native';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  icon: {\r\n    marginRight: theme.spacing(2),\r\n  },\r\n  heroContent: {\r\n    backgroundColor: theme.palette.background.paper,\r\n    padding: theme.spacing(8, 0, 6),\r\n  },\r\n  heroButtons: {\r\n    marginTop: theme.spacing(4),\r\n  },\r\n  captureButton: {\r\n    margin: 'auto',\r\n  },\r\n  cardGrid: {\r\n    paddingTop: theme.spacing(8),\r\n    paddingBottom: theme.spacing(8),\r\n  },\r\n  card: {\r\n    height: '100%',\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n  },\r\n  cardMedia: {\r\n    paddingTop: '56.25%', // 16:9\r\n  },\r\n  cardContent: {\r\n    flexGrow: 1,\r\n  },\r\n  footer: {\r\n    backgroundColor: theme.palette.background.paper,\r\n    padding: theme.spacing(6),\r\n  },\r\n  video: {\r\n    width: '100%',\r\n    height: '50%',\r\n    facingMode: \"user\"\r\n  },\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n  },\r\n  paper: {\r\n    padding: theme.spacing(2),\r\n    textAlign: 'center',\r\n    color: theme.palette.text.secondary,\r\n  },\r\n}));\r\n\r\n// Capture App\r\nfunction Capture({ navigation }) { // Add navigation to the additional pages if requiring access between them\r\n  // Sets the style\r\n  const classes = useStyles();\r\n\r\n  // Sets the web cam, location, image source and comment\r\n  const webcamRef = React.useRef(null);\r\n  const [imgSrc, setImgSrc] = React.useState(null);\r\n  const [imgComment, setImgComment] = React.useState(\"\");\r\n  const [latitude, setLatitude] = React.useState(\"\");\r\n  const [longitude, setLongitude] = React.useState(\"\");\r\n\r\n  // Captures the picture and provides a base64 string of it\r\n  const capture = React.useCallback(\r\n    () => {\r\n      getUser();\r\n      const imageSrc = webcamRef.current.getScreenshot();\r\n      setImgSrc(imageSrc);\r\n      fetch(imageSrc).then(res => res.blob())\r\n        .then(blob => {\r\n          const file2 = new File([blob], \"test.jpg\", { type: \"image/jpg\" });\r\n          console.log(file2);\r\n          EXIF.getData(file2, function() {\r\n            var exifData = EXIF.pretty(this);\r\n            let exifLong = EXIF.getTag(this, \"GPSLongitude\");\r\n            let exifLat = EXIF.getTag(this, \"GPSLatitude\");\r\n            var exifLat_final;\r\n            if (exifLat) {\r\n              var exifLatNum1 =  exifLat[0].numerator / exifLat[0].denominator;\r\n              var exifLatNum2 = exifLat[1].numerator / exifLat[1].denominator;\r\n              var exifLatNum3 = exifLat[2].numerator / exifLat[2].denominator;\r\n              exifLat_final = exifLatNum1 + exifLatNum2/60 + exifLatNum3/3600;\r\n              exifLat_final = exifLat_final.toString();\r\n              setLatitude(exifLat_final);\r\n            }\r\n            var exifLong_final;\r\n            if (exifLong) {\r\n              var exifLongNum1 =  exifLong[0].numerator / exifLong[0].denominator;\r\n              var exifLongNum2 = exifLong[1].numerator / exifLong[1].denominator;\r\n              var exifLongNum3 = exifLong[2].numerator / exifLong[2].denominator;\r\n              exifLong_final = exifLongNum1 + exifLongNum2/60 + exifLongNum3/3600;\r\n              exifLong_final = exifLong_final.toString();\r\n              setLongitude(exifLong_final);\r\n            }\r\n            if (exifLong && exifLat) {\r\n              geocodeLatLng(exifLat_final, exifLong_final);\r\n            }\r\n            console.log(latitude, longitude);\r\n            setLatLongByCurrentPosition(exifLat, exifLong);\r\n          });\r\n        });\r\n    },\r\n    [webcamRef, setImgSrc]\r\n  );\r\n\r\n\r\n\r\n  // Sets the latitude and the longtitude\r\n  function setLatLongByCurrentPosition(lat, long){\r\n    if (lat || long){\r\n      return;\r\n    }\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(getPosition);\r\n    }\r\n    function getPosition(position) {\r\n      console.log(position.coords.latitude, position.coords.longitude);\r\n      var lat_var = position.coords.latitude + \"\";\r\n      var long_var = position.coords.longitude + \"\";\r\n      setLongitude(long_var)\r\n      setLatitude(lat_var)\r\n      geocodeLatLng(lat_var, long_var);\r\n      alert(\"Your photo has been captured\");\r\n    }\r\n  }\r\n\r\n  const [city, setCity] = React.useState(\"\");\r\n  const [suburb, setSuburb] = React.useState(\"\");\r\n  const [country, setCountry] = React.useState(\"\");\r\n\r\n  // Gets a location based on the lat and long\r\n  function geocodeLatLng(lat, long) {\r\n    var API_KEY = \"HedZ30NsSEanvewLY-XkRQ43WOCSSBXqdhr1yvsuPz0\"; // To register a new API key go to developer.here.com and register a javascript api key\r\n    return new Promise((resolve) => {\r\n      const url = `https://reverse.geocoder.ls.hereapi.com/6.2/reversegeocode.json?apiKey=${API_KEY}&mode=retrieveAddresses&prox=${lat},${long}`\r\n      fetch(url)\r\n        .then(res => res.json())\r\n        .then((resJson) => {\r\n          // Getting the address of the location\r\n          if (resJson\r\n            && resJson.Response\r\n            && resJson.Response.View\r\n            && resJson.Response.View[0]\r\n            && resJson.Response.View[0].Result\r\n            && resJson.Response.View[0].Result[0]) {\r\n            var address = resJson.Response.View[0].Result[0].Location.Address;\r\n            setCity(address.City);\r\n            setCountry(address.Country);\r\n            setSuburb(address.District);\r\n            console.log(resJson.Response.View[0].Result[0].Location.Address)\r\n            resolve(resJson.Response.View[0].Result[0].Location.Address.Label)\r\n          } else {\r\n            resolve()\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          console.log('Error in getting the address from the coordinates', e)\r\n          resolve()\r\n        })\r\n    })\r\n  }\r\n\r\n\r\n  const [errorMsg, setErrorMsg] = React.useState(null);\r\n\r\n  // Signs out the used\r\n  const signOut = async () => {\r\n    try {\r\n      await Auth.signOut({ global: true });\r\n    } catch (error) {\r\n      console.log('error signing out: ', error);\r\n    }\r\n  };\r\n\r\n  // Gets the user info of the current user\r\n  const [email, setEmail] = React.useState(\"\")\r\n  const getUser = async () => {\r\n    try {\r\n      let userInfo = await Auth.currentUserInfo()\r\n      setEmail(userInfo.attributes.email);\r\n    } catch (error) {\r\n      console.log('error getting user data: ', error);\r\n    }\r\n  };\r\n\r\n  // Post for sending data to s3 and dynamo db\r\n  const axios = require(\"axios\");\r\n  const apiMethod = () => {\r\n    var imgSrc_API = imgSrc;\r\n    var imgComment_API = imgComment;\r\n    let date = new Date();\r\n    console.log(imgSrc);\r\n    console.log(imgComment);\r\n    console.log(latitude);\r\n    console.log(longitude);\r\n    console.log(email)\r\n    console.log(country);\r\n    console.log(city);\r\n    console.log(suburb);\r\n    axios.post(\"https://7juxc9c5n7.execute-api.ap-southeast-2.amazonaws.com/dev\", {\r\n    comment: imgComment_API,\r\n    image: imgSrc_API,\r\n    latitude: latitude,\r\n    longitude: longitude,\r\n    timestamp: date.toISOString(),\r\n    email: email,\r\n    city: city,\r\n    country: country,\r\n    suburb: suburb\r\n    })\r\n  .then(response => {\r\n    alert(\"Your image has been uploaded!\");\r\n    console.log(response);\r\n   })\r\n  .catch(error => {\r\n    console.log(error);\r\n  })\r\n};\r\n\r\n  // Updates the comment variable\r\n  const commentHandler = (event) => {\r\n    setImgComment(event.target.value);\r\n  }\r\n\r\n  // Renders the app\r\n  return (\r\n    <React.Fragment>\r\n      <CssBaseline />\r\n      {/* Header */}\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <CameraIcon className={classes.icon} />\r\n          <Typography variant=\"h6\" className={classes.title}>\r\n            Citizen Watch\r\n          </Typography>\r\n          <Button color=\"inherit\" onClick={() => signOut()}>Sign Out</Button>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <main>\r\n        {/* Setting up the camera and comment box to upload */}\r\n        <div className={classes.heroContent}>\r\n          <Container maxWidth=\"sm\">\r\n          <Card className={classes.card}>\r\n          <Paper className={classes.paper} elevation={5} variant=\"outlined\">\r\n            <Webcam\r\n              className={classes.video}\r\n              audio={false}\r\n              ref={webcamRef}\r\n              screenshotFormat=\"image/jpeg\"\r\n            />\r\n          </Paper>\r\n          <CardContent className={classes.cardContent}>\r\n            <TextField fullWidth margin=\"normal\" variant=\"filled\" InputLabelProps={{ shrink:true,}}\r\n             placeholder=\"Put your comment here\" onChange={commentHandler}/>\r\n          </CardContent>\r\n          <CardActions>\r\n          <div className={classes.heroButtons}>\r\n            <Grid container spacing={2} justify=\"center\">\r\n              <Grid item>\r\n                <Button variant=\"contained\" color=\"primary\" onClick={() => capture()}>\r\n                  Capture Photo\r\n                </Button>\r\n              </Grid>\r\n              <Grid item>\r\n                <Button variant=\"outlined\" color=\"primary\" onClick={() => apiMethod()}\r\n                disabled={!imgSrc}>\r\n                  Upload\r\n                </Button>\r\n              </Grid>\r\n              <Grid item>\r\n                <Button variant=\"contained\" color=\"primary\" href='/Home'>\r\n                  Home\r\n                </Button>\r\n              </Grid>\r\n            </Grid>\r\n          </div>\r\n          </CardActions>\r\n          </Card>\r\n          </Container>\r\n        </div>\r\n      </main>\r\n    </React.Fragment>\r\n  );\r\n}\r\n\r\nexport default withAuthenticator(Capture);\r\n"]},"metadata":{},"sourceType":"module"}